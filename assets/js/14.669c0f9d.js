(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{377:function(a,t,e){"use strict";e.r(t);var s=e(42),r=Object(s.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"docker-buildx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-buildx"}},[a._v("#")]),a._v(" docker buildx")]),a._v(" "),e("ul",[e("li",[a._v("https://github.com/docker/buildx")])]),a._v(" "),e("h2",{attrs:{id:"创建实例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建实例"}},[a._v("#")]),a._v(" 创建实例")]),a._v(" "),e("p",[a._v("下载 "),e("code",[a._v("https://github.com/docker/buildx/releases")]),a._v("，放入 "),e("code",[a._v("~/.docker/cli-plugins/docker-buildx(.exe)")]),a._v("，并赋予可执行权限。")]),a._v(" "),e("h2",{attrs:{id:"环境变量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#环境变量"}},[a._v("#")]),a._v(" 环境变量")]),a._v(" "),e("p",[a._v("必须设置如下环境变量才能使用 buildx")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("$ "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DOCKER_CLI_EXPERIMENTAL")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("enabled\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v('# $env:DOCKER_CLI_EXPERIMENTAL="enabled"')]),a._v("\n")])])]),e("h3",{attrs:{id:"国内环境使用如下命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#国内环境使用如下命令"}},[a._v("#")]),a._v(" 国内环境使用如下命令")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("$ docker buildx create --use --name"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mybuilder --driver docker-container --driver-opt "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("image")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("dockerpracticesig/buildkit:master\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# kubernetes")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# $ docker buildx create --use --name=mybuilder-k8s --driver kubernetes --driver-opt image=dockerpracticesig/buildkit:master")]),a._v("\n")])])]),e("h3",{attrs:{id:"其他环境-国外-ci-使用如下命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#其他环境-国外-ci-使用如下命令"}},[a._v("#")]),a._v(" 其他环境(国外/CI)使用如下命令")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("$ docker buildx create --use --name"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mybuilder --driver docker-container\n")])])]),e("h2",{attrs:{id:"dockerfile-arg"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile-arg"}},[a._v("#")]),a._v(" Dockerfile ARG")]),a._v(" "),e("div",{staticClass:"language-docker extra-class"},[e("pre",{pre:!0,attrs:{class:"language-docker"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# syntax=docker/dockerfile:experimental")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ARG")]),a._v(" TARGETPLATFORM "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" platform of the build result. Eg linux/amd64"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" linux/arm/v7"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" windows/amd64.\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ARG")]),a._v(" TARGETOS "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" OS component of TARGETPLATFORM\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ARG")]),a._v(" TARGETARCH "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" architecture component of TARGETPLATFORM\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ARG")]),a._v(" TARGETVARIANT "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" variant component of TARGETPLATFORM\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ARG")]),a._v(" BUILDPLATFORM "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" platform of the node performing the build.\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ARG")]),a._v(" BUILDOS "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" OS component of BUILDPLATFORM\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ARG")]),a._v(" BUILDARCH "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" OS component of BUILDPLATFORM\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ARG")]),a._v(" BUILDVARIANT "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" OS component of BUILDPLATFORM\n")])])]),e("h2",{attrs:{id:"构建镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#构建镜像"}},[a._v("#")]),a._v(" 构建镜像")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("$ docker buildx build "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n")])])]),e("p",[a._v("如何使用请参考以下链接")]),a._v(" "),e("ul",[e("li",[a._v("https://vuepress.mirror.docker-practice.com/buildx/multi-arch-images.html")])])])}),[],!1,null,null,null);t.default=r.exports}}]);