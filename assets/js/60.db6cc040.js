(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{414:function(t,s,a){"use strict";a.r(s);var e=a(42),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"minio"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#minio"}},[t._v("#")]),t._v(" Minio")]),t._v(" "),a("ul",[a("li",[t._v("https://docs.min.io/docs/minio-quickstart-guide.html")]),t._v(" "),a("li",[t._v("https://github.com/minio/minio")])]),t._v(" "),a("h2",{attrs:{id:"配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[t._v("#")]),t._v(" 配置")]),t._v(" "),a("p",[t._v("在 "),a("code",[t._v(".env")]),t._v(" 文件中将 "),a("code",[t._v("minio")]),t._v(" 包含进来")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("LNMP_SERVICES")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nginx mysql php8 redis minio"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("LREW_INCLUDE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"minio pcit"')]),t._v("\n")])])]),a("h3",{attrs:{id:"配置-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置-nginx"}},[t._v("#")]),t._v(" 配置 NGINX")]),t._v(" "),a("p",[t._v("将 "),a("code",[t._v("config/nginx/demo.config/minio.config")]),t._v(" 复制为 "),a("code",[t._v("config/nginx/minio.conf")])]),t._v(" "),a("h3",{attrs:{id:"其他配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他配置"}},[t._v("#")]),t._v(" 其他配置")]),t._v(" "),a("p",[t._v("自行在 "),a("code",[t._v(".env")]),t._v(" 文件添加 "),a("a",{attrs:{href:"https://github.com/khs1994-docker/lnmp/blob/master/lrew/minio/.env.compose",target:"_blank",rel:"noopener noreferrer"}},[t._v("minio"),a("OutboundLink")],1),t._v(" 相关变量")]),t._v(" "),a("h4",{attrs:{id:"密钥配置-非常重要"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#密钥配置-非常重要"}},[t._v("#")]),t._v(" 密钥配置（非常重要）")]),t._v(" "),a("p",[t._v("在 "),a("code",[t._v(".env")]),t._v(" 进行配置")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("MINIO_ROOT_USER")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("minioadmin\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("MINIO_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("minioadmin\n")])])]),a("blockquote",[a("p",[t._v("自行修改配置之后，下边命令中的密钥换成你自己设置的！")])]),t._v(" "),a("h4",{attrs:{id:"启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[t._v("#")]),t._v(" 启动")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ ./lnmp-docker up\n")])])]),a("h3",{attrs:{id:"验证"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#验证"}},[t._v("#")]),t._v(" 验证")]),t._v(" "),a("p",[t._v("打开 "),a("code",[t._v("https://minio.t.khs1994.com")])]),t._v(" "),a("p",[a("code",[t._v("minioadmin")])]),t._v(" "),a("p",[a("code",[t._v("minioadmin")])]),t._v(" "),a("p",[t._v("在登录框输入上面密钥即可")]),t._v(" "),a("h2",{attrs:{id:"客户端安装-mc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#客户端安装-mc"}},[t._v("#")]),t._v(" 客户端安装(mc)")]),t._v(" "),a("ul",[a("li",[t._v("https://dl.minio.io/server/minio/release/")]),t._v(" "),a("li",[t._v("https://dl.minio.io/client/mc/release/")])]),t._v(" "),a("p",[t._v("选择对应的操作系统，移入 PATH 即可")]),t._v(" "),a("blockquote",[a("p",[t._v("官网直接下载可能较缓慢。")])]),t._v(" "),a("h3",{attrs:{id:"windows-安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#windows-安装"}},[t._v("#")]),t._v(" Windows 安装")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("$ lnmp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("windows"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("pm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ps1 install minio\n")])])]),a("h3",{attrs:{id:"macos-安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#macos-安装"}},[t._v("#")]),t._v(" macOS 安装")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ brew "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" minio/stable/minio\n\n$ brew "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" minio/stable/mc\n")])])]),a("h3",{attrs:{id:"命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令"}},[t._v("#")]),t._v(" 命令")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动")]),t._v("\n$ minio server /home/shared\n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mc")]),t._v(" config "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("host")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" minio https://minio.t.khs1994.com minioadmin minioadmin\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 上传文件")]),t._v("\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mc")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" /path minio/mybucket\n")])])]),a("h2",{attrs:{id:"laravel"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#laravel"}},[t._v("#")]),t._v(" Laravel")]),t._v(" "),a("p",[t._v("minio API 与 AWS s3 兼容，所以可以很方便的在 Laravel 中使用 minio")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("composer")]),t._v(" require league/flysystem-aws-s3-v3\n")])])]),a("p",[a("code",[t._v("config/filesystems.php")]),t._v(" 中进行如下设置。")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'s3'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'driver'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'s3'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'key'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'AWS_ACCESS_KEY_ID'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'secret'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'AWS_SECRET_ACCESS_KEY'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'region'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'AWS_DEFAULT_REGION'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'us-east-1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 随便填一个")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'bucket'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'AWS_BUCKET'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用前先在 minio web 界面新建一个 bucket")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'use_path_style_endpoint'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean constant"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 必须加上")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'endpoint'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'MINIO_ENDPOINT'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'https://minio.t.khs1994.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shell-comment comment"}},[t._v("# 在 minio 中存储一个文件")]),t._v("\n\\"),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("Storage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("disk")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'s3'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'test.txt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("ul",[a("li",[t._v("https://docs.minio.io/docs/how-to-use-aws-sdk-for-php-with-minio-server.html")])]),t._v(" "),a("h2",{attrs:{id:"版本支持"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#版本支持"}},[t._v("#")]),t._v(" 版本支持")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("历史版本下载 https://dl.min.io/server/minio/release/windows-amd64/archive/")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("RELEASE.2022-05-26T05-48-41Z")]),t._v(" 该版本及之前版本新建 bucket 仍然使用 "),a("strong",[t._v("legacy FS mode")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("RELEASE.2022-06-02T02-11-04Z")]),t._v(" 该版本及之后版本(不存在数据)新建 bucket 使用新模式，旧版本可以升级")])])]),t._v(" "),a("blockquote",[a("p",[t._v("可以通过以下方法使用旧模式\nhttps://www.funkypenguin.co.nz/blog/how-to-run-minio-in-fs-mode-again/")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /path-to-existing-data/.minio.sys/")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"version"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"format"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fs"')]),t._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"avoid-going-into-snsd-mode-legacy-is-fine-with-me"')]),t._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fs"')]),t._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"version"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[a("p",[a("code",[t._v("RELEASE.2022-10-24T18-35-07Z")]),t._v(" 该版本是最后一个兼容 "),a("strong",[t._v("legacy FS mode")]),t._v(" 的版本。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("RELEASE.2022-10-29T06-21-33Z")]),t._v(" 该版本不再兼容 "),a("strong",[t._v("legacy FS mode")]),t._v("(相关代码已经删除)")])])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("ERROR Unable to use the drive /data: Drive /data: found backend "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" fs, expected xl or xl-single:\n")])])]),a("ul",[a("li",[t._v("https://blog.min.io/deprecation-of-the-minio-gateway/?ref=docs")]),t._v(" "),a("li",[t._v("https://min.io/docs/minio/linux/operations/install-deploy-manage/migrate-fs-gateway.html")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("Deprecation of the MinIO gateway\n\non S3 24 February 2022\n\nMinIO is deprecating the gateway and will be completely removed in six months. This should not come as a surprise, we began informing the community in 2020 and have steadily removed unpopular gateways. In the last ten months, MinIO has only made bug fixes.\n\nThe community can continue to use older versions of MinIO past that date. We also encourage any volunteers to step up and maintain open source forks as standalone projects. All modifications and improvements must also be released under the GNU AGPL v3 license.\n\nExisting commercial customers of MinIO will be supported for as long as necessary.\n\nThe reasoning as to why we are deprecating the gateway is relatively straightforward.\n\nWe introduced the gateway feature early on to help make the S3 API ubiquitous. From legacy POSIX-based SAN/NAS systems to modern cloud storage services, the different MinIO gateway modules brought S3 API compatibility where it did not exist previously. The primary objective was to provide sufficient time to port the applications over a modern cloud-native architecture. In the gateway mode, MinIO ran as a stateless proxy service, performing inline translation of the object storage functions from the S3 API to their corresponding equivalent backend functions. At any given time, the MinIO gateway service could be turned off and the only loss was S3 compatibility. The objects were always written to the backend in their native format, be it NFS or Azure Blob, or HDFS.\n\nImplementing different gateways proved to be more challenging than the server mode because it was easier to implement the S3 capabilities in our native erasure-coded backend as compared to competitors' products. The gateway was and still is a great implementation. It worked as advertised, was lightweight and non-intrusive.\n\nSo why are we depreciating it?\n\nThe answer has two parts. First, the MinIO gateway achieved its primary purpose of driving the S3 API's ubiquity.  The goal has been achieved. S3 API is the de facto standard for storage and has made object storage the storage class of the cloud and of Kubernetes. As a result, the gateway merely perpetuates legacy technologies. Gateway users have had years to transition; it is time to let the legacy technologies go.\n\nSecond, the S3 API has evolved considerably since we started, and what began as inline translation morphed into something much more. Critical S3 capabilities like versioning, bucket replication, immutability/object locking, s3-select, encryption, and compression couldn’t be supported in the gateway mode without introducing a proprietary backend format. It would defeat the purpose of the gateway mode because the backend could no longer be read directly without the help of the gateway service. The backends would merely act as storage media for the gateway and you might as well run MinIO in server mode. Thus it became a compromise that MinIO no longer wanted to engage in. This meant it was time for us to let go.\n\nThe class of problems faced by our customers today is suited for the capabilities of the full MinIO Server implementation. In fact, among our commercial customers, the gateway-only usage is less than 2%. Accordingly, we are investing in taking the MinIO server to the next level and so we are deprecating the gateway functionality.\n\nIf you have any questions, feel free to head over to our Slack channel and engage the team. We are happy to answer any questions you might have. If the questions are of a commercial nature, shoot us an email at hello@min.io and we will be sure to respond.\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);