(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{242:function(t,s,e){"use strict";e.r(s);var n=e(0),a=Object(n.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[t._m(0),t._v(" "),e("p",[e("a",{attrs:{href:"https://cloud.tencent.com/redirect.php?redirect=10058&cps_key=3a5255852d5db99dcd5da4c72f05df61",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img.shields.io/badge/AD-%E8%85%BE%E8%AE%AF%E4%BA%91%E5%AE%B9%E5%99%A8%E6%9C%8D%E5%8A%A1-blue.svg",alt:""}}),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://cloud.tencent.com/developer/support-plan?invite_code=13vokmlse8afh",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img.shields.io/badge/Support-%E8%85%BE%E8%AE%AF%E4%BA%91%E8%87%AA%E5%AA%92%E4%BD%93-brightgreen.svg",alt:""}}),e("OutboundLink")],1)]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),e("p",[t._v("部分设置项解释")]),t._v(" "),t._m(8),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._m(23),t._v(" "),e("p",[t._v("安装依赖")]),t._v(" "),t._m(24),e("p",[t._v("挂载")]),t._v(" "),t._m(25),t._m(26),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),t._m(29),t._m(30),t._v(" "),t._m(31),t._m(32),t._m(33),t._v(" "),t._m(34),t._m(35),t._v(" "),t._m(36),t._v(" "),t._m(37),t._m(38),t._v(" "),t._m(39),t._m(40),t._v(" "),t._m(41),t._v(" "),t._m(42),t._m(43),t._m(44),t._v(" "),t._m(45),t._v(" "),t._m(46),t._v(" "),t._m(47),t._m(48),t._v(" "),t._m(49),t._v(" "),t._m(50),t._m(51),t._v(" "),t._m(52),t._v(" "),t._m(53),t._v(" "),t._m(54),t._v(" "),t._m(55),t._v(" "),t._m(56),t._v(" "),t._m(57),t._v(" "),t._m(58),t._v(" "),t._m(59)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"nfs-volume-nfsv4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nfs-volume-nfsv4","aria-hidden":"true"}},[this._v("#")]),this._v(" NFS Volume(NFSv4)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("NFS 数据卷")]),this._v(" 是跨主机的容器数据存储方案之一。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"nfs-各个版本的区别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nfs-各个版本的区别","aria-hidden":"true"}},[this._v("#")]),this._v(" NFS 各个版本的区别")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("https://blog.csdn.net/ycnian/article/details/8515517")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("本文以 "),s("code",[this._v("NFSv4")]),this._v(" 版本为例，无需 RPC "),s("code",[this._v("111")]),this._v(" 端口, 只需监听 "),s("code",[this._v("2049")]),this._v(" 端口即可。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"配置-nfs-server-容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置-nfs-server-容器","aria-hidden":"true"}},[this._v("#")]),this._v(" 配置 NFS Server 容器")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("在 "),s("code",[this._v("kubernetes/volumes/.env")]),this._v(" 文件中配置")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("NFS_EXPORT_N")]),this._v(" 变量值为容器中 "),s("code",[this._v("/etc/exports")]),this._v(" 中的每一行")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("/home/work 192.168.0.*"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rw,fsid"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("0,insecure,sync,no_root_squash"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /home/work 192.168.1.0/24(rw,fsid=0,insecure,sync,no_root_squash)")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /home/work *(rw,fsid=0,insecure,sync,no_root_squash)")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 同一目录的访问规则请写在同一行")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("rw")]),this._v(" read-write 可读写;注意，仅仅这里设置成读写客户端还是不能正常写入，还要正确地设置共享目录的权限，参考问题7")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("ro")]),this._v(" read-only 只读；")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("sync")]),this._v(" 文件同时写入硬盘和内存；")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("async")]),this._v(" 文件暂存于内存，而不是直接写入内存；")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("no_root_squash")]),this._v(" NFS 客户端连接服务端时如果使用的是 root 的话，那么对服务端分享的目录来说，也拥有 root 权限。显然开启这项是不安全的。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("root_squash")]),this._v(" NFS 客户端连接服务端时如果使用的是 root 的话，那么对服务端分享的目录来说，拥有匿名用户权限，通常他将使用 nobody 或 nfsnobody 身份；")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("all_squash")]),this._v(" 不论 NFS 客户端连接服务端时使用什么用户，对服务端分享的目录来说都是拥有匿名用户权限；")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("anonuid")]),this._v(" 匿名用户的 UID 值，通常是 nobody 或 nfsnobody，可以在此处自行设定；")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("anongid")]),this._v(" 匿名用户的 GID 值。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("subtree_check")]),this._v("（默认） 若输出目录是一个子目录，则nfs服务器将检查其父目录的权限；\n"),s("code",[this._v("no_subtree_check")]),this._v(" 即使输出目录是一个子目录，nfs服务器也不检查其父目录的权限，这样可以提高效率；")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("insecure")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"fsid-0"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fsid-0","aria-hidden":"true"}},[this._v("#")]),this._v(" "),s("code",[this._v("fsid=0")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("NFSv4")]),this._v(" 文件系统的命令空间发生了变化，服务器端必须设置一个根文件系统("),s("code",[this._v("fsid=0")]),this._v(")，其他文件系统挂载在根文件系统上导出。")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("/home  192.168.78.0/24"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rw,fsid"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("0,insecure,sync,no_root_squash"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#导出虚拟根目录")]),t._v("\n\n/home/nfs  192.168.78.0/24"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rw,insecure,sync,no_root_squash"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#导出虚拟根下的子目录1")]),t._v("\n\n/home/data  192.168.78.0/24"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rw,insecure,sync,no_root_squash"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#导出虚拟根下的子目录2")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"客户端挂载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#客户端挂载","aria-hidden":"true"}},[this._v("#")]),this._v(" 客户端挂载")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y nfs-common\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y nfs-utils\n")])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("mount")]),t._v(" -t nfs4 -v -o vers"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("4.2 192.168.78.1:/nfs   /tmp/nfs\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("mount")]),t._v(" -t nfs4 -v -o vers"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("4.2 192.168.78.1:/data  /tmp/data\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("-o")]),this._v(" 所支持的参数请通过 "),s("code",[this._v("$ man nfs")]),this._v(" 查看")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"客户端支持的-nfs-版本-o-vers-4-2-与-linux-内核有关"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#客户端支持的-nfs-版本-o-vers-4-2-与-linux-内核有关","aria-hidden":"true"}},[this._v("#")]),this._v(" 客户端支持的 NFS 版本 (-o vers=4.2) 与 Linux 内核有关")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("https://github.com/torvalds/linux/blob/master/fs/nfs/Kconfig")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("CONFIG_NETWORK_FILESYSTEMS"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("y\nCONFIG_NFS_FS"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("y\nCONFIG_NFS_V2"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("y\nCONFIG_NFS_V3"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("y\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# CONFIG_NFS_V3_ACL is not set")]),t._v("\nCONFIG_NFS_V4"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("y\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# CONFIG_NFS_SWAP is not set")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# CONFIG_NFS_V4_1 is not set")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# CONFIG_NFS_V4_2 is not set")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("使用以上参数编译的 Linux 内核不支持 NFS "),s("code",[this._v("4.1")]),this._v(" "),s("code",[this._v("4.2")]),this._v(",添加以下编译参数即可:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("CONFIG_NFS_V4_1"),s("span",{pre:!0,attrs:{class:"token operator"}},[this._v("=")]),this._v("y\nCONFIG_NFS_V4_2"),s("span",{pre:!0,attrs:{class:"token operator"}},[this._v("=")]),this._v("y\n")])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /lib/modules/"),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("uname")]),t._v(" -r"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("/modules.builtin "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" nfs\n\n$ zcat /proc/config.gz "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" NFS\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"加载内核模块"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#加载内核模块","aria-hidden":"true"}},[this._v("#")]),this._v(" 加载内核模块")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" modprobe "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v("{")]),this._v("nfs,nfsd,rpcsec_gss_krb5"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v("}")]),this._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"容器运行-nfs-服务端"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#容器运行-nfs-服务端","aria-hidden":"true"}},[this._v("#")]),this._v(" 容器运行 NFS 服务端")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("https://github.com/ehough/docker-nfs-server")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cd")]),t._v(" kubernetes/volumes\n\n$ docker-compose up "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-d"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" nfs\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或者可以直接执行")]),t._v("\n$ lnmp-docker nfs "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("down"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("或者执行 "),s("code",[this._v("$ docker run XXX")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ docker run -it \\\n    -v /nfs:/nfs:rw \\\n    -p 2049:2049 \\\n    -e NFS_EXPORT_0"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/nfs *(rw,fsid=0,insecure,no_root_squash,no_subtree_check)'")]),t._v("  \\\n    -e NFS_EXPORT_1"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/nfs/data *(rw,insecure,no_root_squash,no_subtree_check)'")]),t._v("  \\\n    -e NFS_DISABLE_VERSION_3"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("1 \\\n    --cap-add SYS_ADMIN \\\n    --privileged \\\n    erichough/nfs-server\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"宿主机安装-nfs-服务端"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#宿主机安装-nfs-服务端","aria-hidden":"true"}},[this._v("#")]),this._v(" 宿主机安装 NFS 服务端")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("https://help.ubuntu.com/community/SettingUpNFSHowTo")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y --no-install-recommends nfs-kernel-server kmod libcap2-bin\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" nfs-utils rpcbind\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" systemctl start nfs\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("编辑 "),s("code",[this._v("/etc/exports")]),this._v(" 文件")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"nfs-客户端尝试挂载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nfs-客户端尝试挂载","aria-hidden":"true"}},[this._v("#")]),this._v(" NFS 客户端尝试挂载")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("客户端必须确保 RPC 协议相应的 portmap 正常运行，否则 mount 将失败 (NFSv3 Only)")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# $ systemctl start rpcbind.service")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# $ showmount -e ${SERVER_IP:-192.168.199.100} # nfs4 not support")]),t._v("\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" /cli-nfs\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 虽然服务端指定的是 /nfs 这里对应为 /")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 必须通过 -t 指定类型，默认为 nfs3 (根据操作系统的不同默认挂载类型也不同)")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("mount")]),t._v(" -v -t nfs4 -o vers"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("4.2,proto"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("tcp,port"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("2049 "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${SERVER_IP:-192.168.199.100}")]),t._v(":/ /cli-nfs\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("mount")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"容器挂载-nfs-volume"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#容器挂载-nfs-volume","aria-hidden":"true"}},[this._v("#")]),this._v(" 容器挂载 NFS Volume")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("https://docs.docker.com/storage/volumes/#choose-the--v-or---mount-flag")]),this._v(" "),s("li",[this._v("https://docs.docker.com/storage/volumes/#create-a-service-which-creates-an-nfs-volume")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建 NFS 数据卷")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Docker 桌面版 支持 vers=4.2")]),t._v("\n$ docker volume create volume-nfs \\\n    -d local \\\n    -o type"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nfs \\\n    -o device"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("192.168.199.100:/ \\\n    -o o"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("addr"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("192.168.199.100,vers"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("4,soft,timeo"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("180,bg,tcp,rw\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 挂载")]),t._v("\n$ docker container run -it --rm \\\n    --mount "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"type=volume,src=volume-nfs,dst=/data"')]),t._v(" \\\n    busybox sh\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或者在 --mount 中直接配置")]),t._v("\n$ docker container run -it --rm \\\n      --mount "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'type=volume,src=volume-nfs,dst=/data,volume-driver=local,volume-opt=type=nfs,volume-opt=device=192.168.199.100:/,\"volume-opt=o=addr=192.168.199.100,vers=4,soft,timeo=180,bg,tcp,rw\"'")]),t._v(" busybox sh\n")])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("p",[t._v("支持哪些 NFS 版本 "),e("code",[t._v("4.2")]),t._v(" "),e("code",[t._v("4.1")]),t._v(" "),e("code",[t._v("4")]),t._v(" 与宿主机一致,可以在宿主机使用 "),e("code",[t._v("$ sudo mount -t nfs4 -v XXX")]),t._v(" 进行测试")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("宿主机不支持 "),s("code",[this._v("4.2")]),this._v(", "),s("code",[this._v("$ docker run")]),this._v(" 指定 "),s("code",[this._v("vers=4.2")]),this._v(" 也会出错")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"compose-中使用-nfs-volume"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#compose-中使用-nfs-volume","aria-hidden":"true"}},[this._v("#")]),this._v(" Compose 中使用 NFS volume")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("请查看 "),s("code",[this._v("scripts/docker-example.yml")]),this._v(" 文件的 "),s("code",[this._v("volumes")]),this._v(" 部分")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"windows-10-挂载-nfs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#windows-10-挂载-nfs","aria-hidden":"true"}},[this._v("#")]),this._v(" Windows 10 挂载 NFS")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("https://docs.microsoft.com/en-us/windows-server/storage/nfs/nfs-overview#windows-and-windows-server-versions")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("只支持 NFSv2, NFSv3")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"more-information"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#more-information","aria-hidden":"true"}},[this._v("#")]),this._v(" More Information")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[e("p",[t._v("https://blog.csdn.net/xuplus/article/details/51669063")])]),t._v(" "),e("li",[e("p",[t._v("https://blog.csdn.net/bbwangj/article/details/78599038")])]),t._v(" "),e("li",[e("p",[t._v("https://blog.csdn.net/younger_china/article/details/52175085")])]),t._v(" "),e("li",[e("p",[t._v("https://github.com/kubernetes/examples/blob/master/staging/volumes/nfs/nfs-server-rc.yaml")])]),t._v(" "),e("li",[e("p",[t._v("https://www.cnblogs.com/lykyl/archive/2013/06/14/3136921.html")])])])}],!1,null,null,null);s.default=a.exports}}]);