(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{458:function(t,s,e){"use strict";e.r(s);var a=e(42),r=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"k8s-on-docker-desktop"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#k8s-on-docker-desktop"}},[t._v("#")]),t._v(" K8s on Docker Desktop")]),t._v(" "),e("h2",{attrs:{id:"gcr-io-local-server"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#gcr-io-local-server"}},[t._v("#")]),t._v(" gcr.io Local Server")]),t._v(" "),e("p",[t._v("修改 Hosts")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1 k8s.gcr.io gcr.io\n")])])]),e("h3",{attrs:{id:"拉取镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#拉取镜像"}},[t._v("#")]),t._v(" 拉取镜像")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ lnmp-docker gcr.io\n")])])]),e("h2",{attrs:{id:"故障排查"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#故障排查"}},[t._v("#")]),t._v(" 故障排查")]),t._v(" "),e("p",[t._v("如果一直启动失败，可以删除以下文件夹之后重新启动 Docker")]),t._v(" "),e("h3",{attrs:{id:"windows"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#windows"}},[t._v("#")]),t._v(" Windows")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("~/.kube")])]),t._v(" "),e("li",[e("code",[t._v("$home\\AppData\\Local\\Docker\\pki")])])]),t._v(" "),e("h2",{attrs:{id:"切换-context"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#切换-context"}},[t._v("#")]),t._v(" 切换 context")]),t._v(" "),e("p",[t._v("之前你可能使用了 "),e("code",[t._v("minikube")]),t._v("，使用以下命令切换到 Docker 桌面版。")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ kubectl config get-contexts\n\nCURRENT   NAME                 CLUSTER                      AUTHINFO             NAMESPACE\n          docker-desktop       docker-desktop               docker-desktop\n*         minikube             minikube                     minikube\n\n$ kubectl config use-context docker-desktop\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 切换回 minikube 的命令")]),t._v("\n\n$ kubectl config use-context minikube\n")])])]),e("h2",{attrs:{id:"部署-lnmp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#部署-lnmp"}},[t._v("#")]),t._v(" 部署 lnmp")]),t._v(" "),e("p",[t._v("参考 "),e("code",[t._v("kubernetes/lnmp")]),t._v(" 文件夹的说明进行部署。")]),t._v(" "),e("h2",{attrs:{id:"相关项目"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#相关项目"}},[t._v("#")]),t._v(" 相关项目")]),t._v(" "),e("ul",[e("li",[t._v("https://github.com/AliyunContainerService/k8s-for-docker-desktop")])]),t._v(" "),e("h2",{attrs:{id:"开发者"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#开发者"}},[t._v("#")]),t._v(" 开发者")]),t._v(" "),e("blockquote",[e("p",[t._v("本项目可能会更新不及时，你可以自行找出 "),e("code",[t._v("Docker 桌面版")]),t._v(" 需要哪些 k8s.gcr.io 镜像")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动本地 k8s.gcr.io 服务器")]),t._v("\n$ lnmp-docker gcr.io --no-pull\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在 docker 设置中启用 k8s")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看日志")]),t._v("\n$ lnmp-docker gcr.io logs\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 根据日志找出 Docker 桌面版 会拉取哪些镜像,例如")]),t._v("\nERRO"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("0285"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" response completed with error                 err.code"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"manifest unknown"')]),t._v(" err.detail"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"unknown tag=v1.18.3"')]),t._v(" err.message"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"manifest unknown"')]),t._v(" go.version"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("go1.11.2 http.request.host"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("k8s.gcr.io http.request.id"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ec12c017-08cf-46cc-8780-22c351d8712b http.request.method"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("GET http.request.remoteaddr"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"172.17.0.1:37926"')]),t._v(" http.request.uri"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/v2/kube-apiserver/manifests/v1.18.3"')]),t._v(" http.request.useragent"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"docker/19.03.12 go/go1.13.10 git-commit/48a66213fe kernel/5.8.0-rc3-microsoft-standard os/linux arch/amd64 UpstreamClient(Go-http-client/1.1)"')]),t._v(" http.response.contenttype"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"application/json; charset=utf-8"')]),t._v("\n http.response.duration"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("207")]),t._v(".384ms http.response.status"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),t._v(" http.response.written"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("97")]),t._v(" vars.name"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("kube-apiserver vars.reference"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("v1.18.3\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 此日志说明需要 k8s.gcr.io/kube-apiserver:v1.18.3")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在 `lnmp-docker(.ps1)` 中更新以下变量的值")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# KUBERNETES_VERSION="1.18.3"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# KUBERNETES_COREDNS_VERSION="1.8.0"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# KUBERNETES_PAUSE_VERSION="3.4.1"')]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);