(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{350:function(a,s,t){"use strict";t.r(s);var e=t(33),r=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"crontab-计划任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#crontab-计划任务"}},[a._v("#")]),a._v(" Crontab 计划任务")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://cloud.tencent.com/redirect.php?redirect=10058&cps_key=3a5255852d5db99dcd5da4c72f05df61",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"https://img.shields.io/badge/AD-%E8%85%BE%E8%AE%AF%E4%BA%91%E5%AE%B9%E5%99%A8%E6%9C%8D%E5%8A%A1-blue.svg",alt:""}}),t("OutboundLink")],1),a._v(" "),t("a",{attrs:{href:"https://cloud.tencent.com/developer/support-plan?invite_code=13vokmlse8afh",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"https://img.shields.io/badge/Support-%E8%85%BE%E8%AE%AF%E4%BA%91%E8%87%AA%E5%AA%92%E4%BD%93-brightgreen.svg",alt:""}}),t("OutboundLink")],1)]),a._v(" "),t("ul",[t("li",[a._v("https://crontab.guru/")])]),a._v(" "),t("h2",{attrs:{id:"编辑宿主机-crontab-配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#编辑宿主机-crontab-配置文件"}},[a._v("#")]),a._v(" 编辑宿主机 crontab 配置文件")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("crontab")]),a._v(" -e\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("* * * * * /usr/local/bin/docker "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" -i "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v(" docker container "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v(" --format "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'{{.ID}}'")]),a._v(" -f "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("label")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("com.khs1994.com -f "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("label")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("com.docker.compose.service"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("php7 "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" -c "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"php /app/path-to-your-project/artisan schedule:run >> /dev/null 2>&1"')]),a._v("\n\n* * * * * /usr/local/bin/docker "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" -i "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v(" docker container "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v(" --format "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'{{.ID}}'")]),a._v(" -f "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("label")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("com.khs1994.com -f "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("label")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("com.docker.swarm.service.name"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("lnmp_php7 "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" -c "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"php /app/path-to-your-project/artisan schedule:run >> /dev/null 2>&1"')]),a._v("\n")])])]),t("p",[a._v("原理：通过在 "),t("strong",[a._v("宿主机")]),a._v(" 计划执行 "),t("code",[a._v("docker exec ***")]),a._v("，变相实现容器内计划任务，只适用于 "),t("strong",[a._v("单机环境")]),a._v("。")])])}),[],!1,null,null,null);s.default=r.exports}}]);